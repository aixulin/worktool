<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本处理工具</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .app-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .text-comparison {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .text-area-container {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 25px;
            display: flex;
            flex-direction: column;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .text-area-wrapper {
            position: relative;
            flex: 1;
            display: flex;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            min-height: 300px;
        }
        
        .line-numbers {
            width: 50px;
            background-color: #f5f5f5;
            padding: 15px 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #7f8c8d;
            text-align: right;
            overflow-y: hidden;
            user-select: none;
            border-right: 1px solid #e0e0e0;
            flex-shrink: 0;
        }
        
        .text-input-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }
        
        textarea {
            flex: 1;
            padding: 15px;
            border: none;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: none;
            line-height: 1.5;
            outline: none;
            overflow-y: auto;
            min-height: 100%;
            background: transparent;
            color: #333;
            caret-color: #333;
            position: relative;
            z-index: 2;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .output-text {
            background-color: #f8f9fa;
            color: #2c3e50;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #e74c3c;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }
        
        .btn-convert {
            background: #9b59b6;
            color: white;
        }
        
        .btn-convert:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }
        
        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            padding: 10px;
            background: #ffeaea;
            border-radius: 6px;
            display: none;
        }
        
        .success-message {
            color: #27ae60;
            margin-top: 10px;
            padding: 10px;
            background: #eaffea;
            border-radius: 6px;
            display: none;
        }
        
        footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        @media (max-width: 768px) {
            .text-comparison {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        .copy-btn {
            background: #f39c12;
            color: white;
        }
        
        .copy-btn:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }
        
        .line-count {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .char-count {
            font-size: 0.9rem;
            color: #3498db;
            margin-left: 10px;
        }
        
        .output-char-count {
            color: #9b59b6;
        }
        
        .conversion-dropdown {
            padding: 12px 15px;
            border: 2px solid #3498db;
            border-radius: 6px;
            font-size: 1rem;
            background: white;
            color: #2c3e50;
            cursor: pointer;
            outline: none;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
        }
        
        .conversion-dropdown:focus {
            border-color: #2980b9;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .conversion-dropdown option {
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>文本处理工具</h1>
        </header>
        
        <div class="app-container">
            <div class="text-comparison">
                <div class="text-area-container">
                    <h2 class="section-title">
                        输入文本
                        <span class="line-count">
                            行数: <span id="lineCount1">0</span>
                            <span class="char-count">字符: <span id="charCount1">0</span></span>
                        </span>
                    </h2>
                    <div class="text-area-wrapper" id="wrapper1">
                        <div class="line-numbers" id="lineNumbers1"></div>
                        <div class="text-input-container">
                            <textarea id="inputText" placeholder="请输入英文文本...">Hello, this is a sample text for conversion.
It contains multiple lines and various English words.
You can type or paste any English text here.
The tool will convert all letters to UPPERCASE or lowercase.</textarea>
                        </div>
                    </div>
                </div>
                
                <div class="text-area-container">
                    <h2 class="section-title">
                        转换结果
                        <span class="line-count">
                            行数: <span id="lineCount2">0</span>
                            <span class="char-count output-char-count">字符: <span id="charCount2">0</span></span>
                        </span>
                    </h2>
                    <div class="text-area-wrapper" id="wrapper2">
                        <div class="line-numbers" id="lineNumbers2"></div>
                        <div class="text-input-container">
                            <textarea id="outputText" class="output-text" placeholder="转换结果将在这里显示..." readonly></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <select class="conversion-dropdown" id="conversionType">
                    <option value="uppercase">转换为大写</option>
                    <option value="lowercase">转换为小写</option>
                    <option value="removeSpaces">删除所有空格</option>
                    <option value="removeEmptyLines">删除所有空行</option>
                    <option value="removeDuplicateLines">删除重复行</option>
                </select>
                <button class="btn-convert" id="convertBtn">执行转换</button>
                <button class="copy-btn" id="copyBtn">复制结果</button>
                <button class="btn-success" id="exampleBtn">加载示例</button>
                <button class="btn-secondary" id="clearBtn">清空文本</button>
            </div>
            
            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage"></div>
        </div>
        
        <footer>
            <p>微信搜索【职场高效工具箱】解锁更多高效办公工具</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputText = document.getElementById('inputText');
            const outputText = document.getElementById('outputText');
            const convertBtn = document.getElementById('convertBtn');
            const exampleBtn = document.getElementById('exampleBtn');
            const clearBtn = document.getElementById('clearBtn');
            const copyBtn = document.getElementById('copyBtn');
            const conversionType = document.getElementById('conversionType');
            const errorMessage = document.getElementById('errorMessage');
            const successMessage = document.getElementById('successMessage');
            const lineNumbers1 = document.getElementById('lineNumbers1');
            const lineNumbers2 = document.getElementById('lineNumbers2');
            const lineCount1 = document.getElementById('lineCount1');
            const lineCount2 = document.getElementById('lineCount2');
            const charCount1 = document.getElementById('charCount1');
            const charCount2 = document.getElementById('charCount2');
            
            // 示例数据
            const exampleData = `Hello, this is a sample text for conversion.
It contains multiple lines and various English words.
You can type or paste any English text here.
The tool will convert all letters to UPPERCASE or lowercase.`;
            
            // 初始化
            updateLineNumbers(inputText, lineNumbers1, lineCount1, charCount1);
            updateLineNumbers(outputText, lineNumbers2, lineCount2, charCount2);
            convertText();
            
            // 启用实时转换
            inputText.addEventListener('input', handleTextChange);
            conversionType.addEventListener('change', handleTextChange);
            
            // 加载示例数据
            exampleBtn.addEventListener('click', function() {
                inputText.value = exampleData;
                hideMessages();
                updateLineNumbers(inputText, lineNumbers1, lineCount1, charCount1);
                convertText();
            });
            
            // 清空数据
            clearBtn.addEventListener('click', function() {
                inputText.value = '';
                outputText.value = '';
                hideMessages();
                updateLineNumbers(inputText, lineNumbers1, lineCount1, charCount1);
                updateLineNumbers(outputText, lineNumbers2, lineCount2, charCount2);
                showSuccess('文本已清空');
            });
            
            // 执行转换
            convertBtn.addEventListener('click', function() {
                convertText();
            });
            
            // 复制结果
            copyBtn.addEventListener('click', function() {
                if (outputText.value.trim() === '') {
                    showError('没有可复制的内容');
                    return;
                }
                
                outputText.select();
                document.execCommand('copy');
                showSuccess('已复制到剪贴板');
            });
            
            // 文本变化处理
            function handleTextChange() {
                updateLineNumbers(inputText, lineNumbers1, lineCount1, charCount1);
                convertText();
            }
            
            // 更新行号显示
            function updateLineNumbers(textarea, lineNumbersElement, lineCountElement, charCountElement) {
                const lines = textarea.value.split('\n').length;
                const chars = textarea.value.length;
                
                lineCountElement.textContent = lines;
                charCountElement.textContent = chars;
                
                let numbersHTML = '';
                for (let i = 1; i <= lines; i++) {
                    numbersHTML += `<div>${i}</div>`;
                }
                lineNumbersElement.innerHTML = numbersHTML;
                
                // 同步滚动
                lineNumbersElement.scrollTop = textarea.scrollTop;
            }
            
            // 同步滚动
            inputText.addEventListener('scroll', function() {
                lineNumbers1.scrollTop = this.scrollTop;
            });
            
            outputText.addEventListener('scroll', function() {
                lineNumbers2.scrollTop = this.scrollTop;
            });
            
            // 文本框自适应高度
            function autoResizeTextarea(textarea) {
                // 重置高度为auto以正确计算scrollHeight
                textarea.style.height = 'auto';
                // 设置高度为scrollHeight
                textarea.style.height = textarea.scrollHeight + 'px';
                
                // 同步容器高度
                const wrapper = textarea.closest('.text-area-wrapper');
                if (wrapper) {
                    wrapper.style.height = 'auto';
                    wrapper.style.height = textarea.scrollHeight + 'px';
                }
            }
            
            // 初始化自适应高度
            autoResizeTextarea(inputText);
            autoResizeTextarea(outputText);
            
            // 监听输入变化，调整高度
            inputText.addEventListener('input', function() {
                autoResizeTextarea(this);
            });
            
            // 隐藏所有消息
            function hideMessages() {
                errorMessage.style.display = 'none';
                successMessage.style.display = 'none';
            }
            
            // 显示错误消息
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
            }
            
            // 显示成功消息
            function showSuccess(message) {
                successMessage.textContent = message;
                successMessage.style.display = 'block';
                errorMessage.style.display = 'none';
            }
            
            // 转换文本
            function convertText() {
                hideMessages();
                
                const inputValue = inputText.value;
                const type = conversionType.value;
                
                if (!inputValue) {
                    outputText.value = '';
                    updateLineNumbers(outputText, lineNumbers2, lineCount2, charCount2);
                    showError('请输入要转换的文本');
                    return;
                }
                
                try {
                    let convertedText;
                    let successMessageText;
                    
                    if (type === 'uppercase') {
                        convertedText = inputValue.toUpperCase();
                        successMessageText = '文本已成功转换为大写';
                    } else if (type === 'lowercase') {
                        convertedText = inputValue.toLowerCase();
                        successMessageText = '文本已成功转换为小写';
                    } else if (type === 'removeSpaces') {
                        convertedText = inputValue.replace(/\s/g, '');
                        successMessageText = '文本已成功删除所有空格';
                    } else if (type === 'removeEmptyLines') {
                        convertedText = inputValue.split('\n').filter(line => line.trim() !== '').join('\n');
                        successMessageText = '文本已成功删除所有空行';
                    } else {
                        const lines = inputValue.split('\n');
                        const uniqueLines = [];
                        const seenLines = new Set();
                        
                        for (const line of lines) {
                            if (!seenLines.has(line)) {
                                uniqueLines.push(line);
                                seenLines.add(line);
                            }
                        }
                        
                        convertedText = uniqueLines.join('\n');
                        successMessageText = '文本已成功删除重复行';
                    }
                    
                    outputText.value = convertedText;
                    
                    // 更新行号和统计信息
                    updateLineNumbers(outputText, lineNumbers2, lineCount2, charCount2);
                    
                    showSuccess(successMessageText);
                } catch (error) {
                    showError(`转换过程中出错: ${error.message}`);
                }
            }
        });
    </script>
</body>
</html>